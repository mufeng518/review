### MySQL简介

##### SQL概述

SQL是Structured Query Language的简称，是一门数据查询和程序设计的语言。

##### MySQL优化范围

* 字段类型优化

* 插入优化

    连接MySQL服务器->选择数据库->语法分析->验证表->插入数据->断开连接
    
* 查询优化

* 表优化

* 数据库优化

* 引擎优化

* 硬盘优化

##### SQL注入

```mysql
or 1=1 --
```

### `innodb`和`myisam`的区别

* 事务机制

    `innodb`是事务安全的，但由于`innodb`默认情况下的`autocommit`是开启的，即每条SQL语句都会被默认封装一个事务自动提交，这样会严重影响数据库的性能，所以通常情况下最好一次性把多条SQL语句单独封装成一个事务再去提交。
    
    `myisam`是非事务安全的。
    
* `CURD`

    `innodb`在`CUD`操作上性能更好；
    
    `myisam`在`R`操作上性能更好。
    
* 存储结构

    `innodb`会将一张数据表存储成两个文件，分别是`表名.frm`和`表名.ibd`；
    
    `myisam`会将一张数据表存储成三个文件，分别是`表名.frm`、`表名.MYI`和`表名.MYD`。
    
* 外键

    `innodb`支持外键；
    
    `myisam`不支持外键。
    
* 全文索引

    `innodb`不支持全文索引；
    
    `myisam`支持全文索引。
    
* 可移植性

    `innodb`环境下的数据文件不支持移动；
    
    `myisam`环境下的数据文件支持移动。

### 字符集和校对集

##### 字符集的使用环境

* 保存数据时使用

    > 附：常用字符集
    >
    > `gb2312` `gbk` `utf8` `utf8mb4`

* 传递数据时使用

    > 附：查看当前MySQL使用的字符集
    >
    > ```mysql
    > show variables like "character_%";
    > ```
    >
    > 临时修改当前MySQL的字符集
    >
    > ```mysql
    > set names 新字符集;
    > ```

##### 校对集

* 概述

    校对集是在某种字符集下让字符和字符间形成某种关系的集合。

* 查看当前MySQL系统支持的校对集

    ```mysql
    show collation;
    ```

* 分类

    * 区分大小写
    
        ```mysql
        字符集_bin
        ```
    
    * 不区分大小写
    
        ```mysql
        字符集_general_ci
        ```

### 字段类型

##### 整型

`tinyint` 1 -128~127

`int` 4 -21亿~21亿

`bigint` 8 范围更大

##### 无符号的

`unsigned`

##### 零填充

`zerofill`

##### 浮点型

`float(m,d)` 4

`double(m,d)` 8

`decimal(m,d)`

##### 字符串类型

`char(m)` 255

`varchar(m)` 65535

##### 枚举类型

* 优点

    限制输入范围
    
    减少存储空间
    
    提高执行效率

* 结构

    `enum(可选项, ...)`

* 索引的计算方式

    `1, ...`

##### 集合类型

* 结构

    `set(可选项, ...)`

* 索引的计算方式

    `2^0, ...`

* 为什么实际开发中一般不使用集合类型

    因为实际开发中多选框的可选项至少有成百上千个，这样会导致索引所占据的存储空间极大，所以实际开发中一般不使用集合数据类型。

* 多选框的问题该如何解决

    将多选框的可选项单独存放在一张数据表中。

##### 日期时间类型

`date` 1000.01.01~9999.12.31

`datetime` 1000.01.01 00:00:00 9999.12.31 23:59:59

##### 布尔类型

`boolean`

### 完整性约束条件

##### 空或非空

`null` `not null`

##### 默认值

`default 默认值`

##### 自增长

`auto_increment`

> 注：
>
> 当全列插入时使用`null`来占位，但插入成功以后以实际数据为准。

##### 备注

`comment 备注`

### 数据完整性

* 从字段类型角度出发

    数据完整性 = 正确性 + 准确性
    
* 从表结构角度出发

    数据完整性 = 域完整性 + 实体完整性 + 引用完整性 + 自定义完整性

### 用户管理

##### 创建

```mysql
create user '用户名'@'ip地址/%' identified by '密码';
```

##### 授予权限

```mysql
grant 权限名, .../all privileges on `数据库名`/ *.`表名`/ * to '用户名'@'ip地址/%';
```

##### 撤销权限

```mysql
revoke 权限名, .../all privileges on `数据库名`/ *.`表名`/ * from '用户名'@'ip地址/%';
```

##### 刷新权限

```mysql
flush privileges;
```

##### 查看权限

```mysql
show grants for 用户名@ip地址;
```

##### 删除

```mysql
drop user '用户名'@'ip地址/%';
```

### 常用语句

##### 判断语句

* `if`判断

    ```mysql
    if(条件语句, 条件语句为ture时返回的结果, 条件语句为false时返回的结果)
    ```

* `if-else`

    ```mysql
    if 条件语句 then
      ...
    elseif 条件语句 then
      ...
    ...
    end if;
    ```

##### 循环语句

```mysql
别名:while 条件语句 do
    ...
end while;
```

> 附：
>
> `iterable 别名;` `leave 别名;`